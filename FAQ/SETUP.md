# Инструкция по настройке и запуску

## Шаг 1: Установка зависимостей

```bash
pip install -r requirements.txt
```

## Шаг 2: Настройка переменных окружения

1. Скопируйте `.env.example` в `.env`:
```bash
copy .env.example .env
```

2. Откройте `.env` и заполните:
   - `TELEGRAM_BOT_TOKEN` - получите у [@BotFather](https://t.me/BotFather) в Telegram
   - `OPENAI_API_KEY` - получите на [platform.openai.com](https://platform.openai.com)

## Шаг 3: Получение токена Telegram бота

1. Откройте Telegram и найдите [@BotFather](https://t.me/BotFather)
2. Отправьте команду `/newbot`
3. Следуйте инструкциям для создания бота
4. Скопируйте полученный токен в файл `.env`

## Шаг 4: Получение API ключа OpenAI

1. Зарегистрируйтесь на [platform.openai.com](https://platform.openai.com)
2. Перейдите в раздел API Keys
3. Создайте новый ключ
4. Скопируйте ключ в файл `.env`

## Шаг 5: Запуск бота

```bash
python main.py
```

При первом запуске бот загрузит базу знаний в векторную БД. Это может занять несколько минут.

## Шаг 6: Тестирование

1. Найдите вашего бота в Telegram по имени, которое вы указали при создании
2. Отправьте команду `/start`
3. Попробуйте различные запросы:
   - FAQ вопросы: "Как изменить пароль?"
   - Простые проблемы: "Медленно работает портал"
   - Критические проблемы: "Система полностью недоступна"

## Структура проекта

```
ai_client_helper/
├── bot/                    # Модули бота
│   ├── __init__.py
│   ├── telegram_bot.py     # Telegram бот
│   ├── rag_system.py       # RAG система
│   ├── classifier.py       # Классификатор
│   └── escalation.py       # Система эскалации
├── knowledge_base/         # База знаний
│   ├── faq/               # FAQ документы
│   ├── articles/          # Статьи
│   └── tickets/           # Примеры обращений
├── data/                   # Данные
│   ├── tickets.json       # Созданные обращения
│   ├── test_dialogues.md  # Тестовые диалоги
│   ├── test_queries.txt    # Тестовые запросы
│   └── scenarios.md       # Сценарии работы
├── main.py                 # Точка входа
├── requirements.txt        # Зависимости
└── README.md              # Документация
```

## Возможные проблемы

### Ошибка: "TELEGRAM_BOT_TOKEN не найден"
- Убедитесь, что файл `.env` существует и содержит правильный токен
- Проверьте, что токен не содержит лишних пробелов

### Ошибка: "OPENAI_API_KEY не найден"
- Убедитесь, что API ключ указан в `.env`
- Проверьте баланс на аккаунте OpenAI

### Ошибка при загрузке базы знаний
- Убедитесь, что все файлы в `knowledge_base/` имеют расширение `.md`
- Проверьте права доступа к директориям

### Бот не отвечает
- Проверьте логи в консоли
- Убедитесь, что бот запущен
- Проверьте подключение к интернету

## Дополнительная настройка

### Изменение модели OpenAI

В файле `bot/rag_system.py` и `bot/classifier.py` можно изменить модель:
```python
self.llm = ChatOpenAI(temperature=0, model_name="gpt-4")  # Вместо gpt-3.5-turbo
```

### Настройка количества результатов RAG

В файле `bot/rag_system.py`:
```python
retriever=self.vectorstore.as_retriever(search_kwargs={"k": 5})  # Вместо 3
```

### Добавление новых документов в базу знаний

1. Добавьте `.md` файлы в соответствующие директории `knowledge_base/`
2. Перезапустите бота - он автоматически переиндексирует базу знаний

## Мониторинг обращений

Все созданные обращения сохраняются в `data/tickets.json`. Вы можете просматривать их для анализа работы системы.

